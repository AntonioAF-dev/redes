<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SGILAB ‚Äî Sistema de Gesti√≥n de Inventario de Laboratorio</title>
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Exo+2:wght@300;400;600;700;900&display=swap" rel="stylesheet">
<style>
  :root {
    --bg-deep: #060b14;
    --bg-panel: #0d1626;
    --bg-card: #111d33;
    --bg-input: #0a1422;
    --accent-cyan: #00e5ff;
    --accent-blue: #2979ff;
    --accent-green: #00e676;
    --accent-amber: #ffc400;
    --accent-red: #ff1744;
    --text-primary: #e8f4fd;
    --text-secondary: #7ea8c4;
    --text-muted: #3d6080;
    --border: #1a3050;
    --border-bright: #204060;
    --mono: 'Share Tech Mono', monospace;
    --sans: 'Exo 2', sans-serif;
    --radius: 6px;
    --glow-cyan: 0 0 20px rgba(0,229,255,0.25);
    --glow-blue: 0 0 20px rgba(41,121,255,0.3);
  }

  * { margin:0; padding:0; box-sizing:border-box; }

  body {
    background: var(--bg-deep);
    color: var(--text-primary);
    font-family: var(--sans);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Background grid texture */
  body::before {
    content:'';
    position:fixed; inset:0;
    background-image:
      linear-gradient(rgba(0,229,255,0.025) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0,229,255,0.025) 1px, transparent 1px);
    background-size: 40px 40px;
    pointer-events:none; z-index:0;
  }

  /* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
  header {
    position: sticky; top:0; z-index:100;
    background: rgba(6,11,20,0.95);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--border-bright);
    padding: 0 28px;
    display: flex; align-items: center; gap: 20px;
    height: 64px;
    box-shadow: 0 4px 30px rgba(0,0,0,0.5);
  }

  .logo-mark {
    display: flex; align-items: center; gap: 10px;
  }
  .logo-icon {
    width: 36px; height: 36px;
    border: 2px solid var(--accent-cyan);
    border-radius: 8px;
    display: grid; place-items: center;
    color: var(--accent-cyan);
    font-family: var(--mono);
    font-size: 14px; font-weight:bold;
    box-shadow: var(--glow-cyan);
    position:relative;
  }
  .logo-icon::after {
    content:'';
    position:absolute; inset:-6px;
    border: 1px solid rgba(0,229,255,0.15);
    border-radius: 11px;
  }
  .logo-text { font-weight:900; font-size:18px; letter-spacing:3px; color:var(--text-primary); }
  .logo-sub { font-family:var(--mono); font-size:10px; color:var(--text-muted); letter-spacing:2px; margin-top:1px; }

  nav { margin-left:auto; display:flex; gap:4px; }
  nav button {
    background: transparent; border: none; cursor:pointer;
    padding: 8px 16px; border-radius: var(--radius);
    font-family: var(--sans); font-size:13px; font-weight:600;
    color: var(--text-secondary); letter-spacing:1px;
    transition: all 0.2s;
    display:flex; align-items:center; gap:6px;
  }
  nav button:hover { color:var(--accent-cyan); background: rgba(0,229,255,0.06); }
  nav button.active { color:var(--accent-cyan); background: rgba(0,229,255,0.1); border: 1px solid rgba(0,229,255,0.2); }

  /* ‚îÄ‚îÄ MAIN LAYOUT ‚îÄ‚îÄ */
  main { position:relative; z-index:1; padding: 28px; max-width: 1600px; margin: 0 auto; }

  /* ‚îÄ‚îÄ SECTION TITLES ‚îÄ‚îÄ */
  .section-head {
    display:flex; align-items:center; justify-content:space-between;
    margin-bottom:24px;
  }
  .section-title {
    font-size:22px; font-weight:700; letter-spacing:2px;
    color: var(--text-primary);
  }
  .section-title span { color: var(--accent-cyan); }
  .section-badge {
    font-family:var(--mono); font-size:11px; color:var(--text-muted);
    background: var(--bg-panel); padding: 4px 10px; border-radius:20px;
    border: 1px solid var(--border);
  }

  /* ‚îÄ‚îÄ DASHBOARD ‚îÄ‚îÄ */
  .stats-grid {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(180px,1fr));
    gap:16px; margin-bottom:28px;
  }
  .stat-card {
    background: var(--bg-panel);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 20px;
    position:relative; overflow:hidden;
    transition: border-color 0.2s, transform 0.2s;
  }
  .stat-card:hover { border-color: var(--border-bright); transform: translateY(-2px); }
  .stat-card::before {
    content:''; position:absolute; top:0; left:0; right:0; height:2px;
  }
  .stat-card.cyan::before { background: var(--accent-cyan); box-shadow: var(--glow-cyan); }
  .stat-card.green::before { background: var(--accent-green); }
  .stat-card.amber::before { background: var(--accent-amber); }
  .stat-card.red::before { background: var(--accent-red); }
  .stat-card.blue::before { background: var(--accent-blue); }
  .stat-label { font-size:11px; font-weight:600; letter-spacing:2px; color:var(--text-muted); text-transform:uppercase; }
  .stat-value { font-family:var(--mono); font-size:36px; color:var(--text-primary); margin:6px 0 2px; line-height:1; }
  .stat-sub { font-size:12px; color:var(--text-secondary); }

  /* ‚îÄ‚îÄ EQUIPMENT TABLE ‚îÄ‚îÄ */
  .table-toolbar {
    display:flex; align-items:center; gap:12px; margin-bottom:16px;
    flex-wrap:wrap;
  }
  .search-wrap {
    display:flex; align-items:center; gap:8px;
    background:var(--bg-panel); border:1px solid var(--border);
    border-radius:var(--radius); padding:0 14px;
    flex:1; min-width:220px; max-width:400px;
    transition: border-color 0.2s;
  }
  .search-wrap:focus-within { border-color:var(--accent-cyan); box-shadow: var(--glow-cyan); }
  .search-wrap input {
    background:transparent; border:none; outline:none;
    font-family:var(--mono); font-size:13px; color:var(--text-primary);
    padding:10px 0; width:100%;
  }
  .search-wrap input::placeholder { color:var(--text-muted); }
  .search-icon { color:var(--text-muted); font-size:14px; flex-shrink:0; }

  .btn {
    display:inline-flex; align-items:center; gap:7px;
    padding:9px 18px; border-radius:var(--radius);
    font-family:var(--sans); font-size:13px; font-weight:700;
    letter-spacing:0.5px; cursor:pointer; border:1px solid transparent;
    transition: all 0.2s; white-space:nowrap;
  }
  .btn-primary {
    background: var(--accent-blue); color:#fff;
    border-color: var(--accent-blue);
    box-shadow: 0 0 16px rgba(41,121,255,0.35);
  }
  .btn-primary:hover { background:#1565c0; box-shadow: var(--glow-blue); }
  .btn-cyan {
    background: rgba(0,229,255,0.1); color:var(--accent-cyan);
    border-color: rgba(0,229,255,0.3);
  }
  .btn-cyan:hover { background: rgba(0,229,255,0.18); border-color:var(--accent-cyan); }
  .btn-green {
    background: rgba(0,230,118,0.1); color:var(--accent-green);
    border-color: rgba(0,230,118,0.3);
  }
  .btn-green:hover { background: rgba(0,230,118,0.18); }
  .btn-amber {
    background: rgba(255,196,0,0.1); color:var(--accent-amber);
    border-color: rgba(255,196,0,0.3);
  }
  .btn-amber:hover { background: rgba(255,196,0,0.18); }
  .btn-sm { padding:6px 12px; font-size:12px; }
  .btn-ghost { background:transparent; color:var(--text-secondary); border-color:var(--border); }
  .btn-ghost:hover { color:var(--text-primary); border-color:var(--border-bright); }
  .btn-danger { background: rgba(255,23,68,0.1); color:var(--accent-red); border-color:rgba(255,23,68,0.3); }
  .btn-danger:hover { background: rgba(255,23,68,0.2); }

  .table-wrap {
    background:var(--bg-panel); border:1px solid var(--border);
    border-radius:var(--radius); overflow:hidden;
  }
  table { width:100%; border-collapse:collapse; }
  thead { background: rgba(0,229,255,0.06); border-bottom: 1px solid var(--border-bright); }
  th {
    padding: 12px 16px; text-align:left;
    font-family:var(--mono); font-size:11px; font-weight:400;
    letter-spacing:1.5px; color:var(--text-muted); text-transform:uppercase;
    white-space:nowrap;
  }
  td {
    padding: 12px 16px; font-size:13px; color:var(--text-secondary);
    border-bottom: 1px solid rgba(26,48,80,0.5);
    white-space:nowrap;
  }
  tr:last-child td { border-bottom:none; }
  tbody tr { transition: background 0.15s; }
  tbody tr:hover { background: rgba(0,229,255,0.04); }
  .td-mono { font-family:var(--mono); font-size:12px; }
  .td-bold { color:var(--text-primary); font-weight:600; }

  .badge {
    display:inline-flex; align-items:center; gap:5px;
    padding:3px 9px; border-radius:20px;
    font-size:11px; font-weight:700; letter-spacing:0.5px;
  }
  .badge::before { content:''; width:6px; height:6px; border-radius:50%; }
  .badge-good { background:rgba(0,230,118,0.12); color:var(--accent-green); border:1px solid rgba(0,230,118,0.2); }
  .badge-good::before { background:var(--accent-green); }
  .badge-warn { background:rgba(255,196,0,0.12); color:var(--accent-amber); border:1px solid rgba(255,196,0,0.2); }
  .badge-warn::before { background:var(--accent-amber); }
  .badge-bad { background:rgba(255,23,68,0.12); color:var(--accent-red); border:1px solid rgba(255,23,68,0.2); }
  .badge-bad::before { background:var(--accent-red); }
  .badge-info { background:rgba(0,229,255,0.12); color:var(--accent-cyan); border:1px solid rgba(0,229,255,0.2); }
  .badge-info::before { background:var(--accent-cyan); }

  /* ‚îÄ‚îÄ MODAL ‚îÄ‚îÄ */
  .modal-overlay {
    display:none; position:fixed; inset:0; z-index:200;
    background: rgba(0,0,0,0.75);
    backdrop-filter: blur(4px);
    overflow-y:auto; padding:24px;
  }
  .modal-overlay.open { display:flex; align-items:flex-start; justify-content:center; }
  .modal {
    background: var(--bg-panel);
    border: 1px solid var(--border-bright);
    border-radius:10px;
    width:100%; max-width:900px;
    box-shadow: 0 40px 80px rgba(0,0,0,0.6), var(--glow-cyan);
    animation: modalIn 0.3s cubic-bezier(0.34,1.56,0.64,1);
  }
  @keyframes modalIn {
    from { opacity:0; transform:translateY(-20px) scale(0.97); }
    to   { opacity:1; transform:translateY(0) scale(1); }
  }
  .modal-header {
    display:flex; align-items:center; justify-content:space-between;
    padding:20px 24px; border-bottom:1px solid var(--border);
  }
  .modal-title { font-size:16px; font-weight:700; letter-spacing:1.5px; }
  .modal-close {
    background:transparent; border:none; cursor:pointer;
    color:var(--text-muted); font-size:20px; line-height:1;
    transition:color 0.2s;
  }
  .modal-close:hover { color:var(--accent-red); }
  .modal-body { padding:24px; }
  .modal-footer {
    display:flex; justify-content:flex-end; gap:10px;
    padding:16px 24px; border-top:1px solid var(--border);
  }

  /* ‚îÄ‚îÄ FORM ‚îÄ‚îÄ */
  .form-section {
    margin-bottom:28px;
  }
  .form-section-title {
    font-family:var(--mono); font-size:11px; letter-spacing:2px;
    color:var(--accent-cyan); text-transform:uppercase;
    margin-bottom:14px;
    padding-bottom:8px; border-bottom:1px solid rgba(0,229,255,0.15);
    display:flex; align-items:center; gap:8px;
  }
  .form-section-title::before {
    content:''; width:3px; height:14px;
    background:var(--accent-cyan); border-radius:2px;
  }
  .form-grid { display:grid; gap:14px; grid-template-columns: repeat(auto-fit, minmax(200px,1fr)); }
  .form-group { display:flex; flex-direction:column; gap:5px; }
  .form-group.full { grid-column:1/-1; }
  label {
    font-size:11px; font-weight:700; letter-spacing:1px;
    color:var(--text-muted); text-transform:uppercase;
  }
  input, select, textarea {
    background: var(--bg-input);
    border: 1px solid var(--border);
    border-radius:var(--radius);
    padding: 9px 12px;
    font-family: var(--mono); font-size:13px;
    color: var(--text-primary);
    outline:none; transition: border-color 0.2s, box-shadow 0.2s;
    width:100%;
  }
  input:focus, select:focus, textarea:focus {
    border-color: var(--accent-cyan);
    box-shadow: var(--glow-cyan);
  }
  select option { background: var(--bg-card); }
  textarea { resize:vertical; min-height:80px; }
  .input-error { border-color: var(--accent-red) !important; }
  .error-msg { font-size:11px; color:var(--accent-red); margin-top:3px; }

  /* ‚îÄ‚îÄ DETAIL VIEW ‚îÄ‚îÄ */
  .detail-grid {
    display:grid; grid-template-columns:1fr 1fr;
    gap:16px; margin-bottom:20px;
  }
  .detail-section {
    background:var(--bg-card); border:1px solid var(--border);
    border-radius:var(--radius); padding:18px;
  }
  .detail-section-title {
    font-family:var(--mono); font-size:10px; letter-spacing:2px;
    color:var(--accent-cyan); text-transform:uppercase;
    margin-bottom:14px; padding-bottom:8px;
    border-bottom:1px solid rgba(0,229,255,0.1);
  }
  .detail-row {
    display:flex; justify-content:space-between; align-items:flex-start;
    padding:6px 0; border-bottom:1px solid rgba(26,48,80,0.4);
    gap:10px;
  }
  .detail-row:last-child { border-bottom:none; }
  .detail-key { font-size:11px; color:var(--text-muted); flex-shrink:0; }
  .detail-val { font-family:var(--mono); font-size:12px; color:var(--text-primary); text-align:right; word-break:break-all; }

  /* ‚îÄ‚îÄ SECTIONS VISIBILITY ‚îÄ‚îÄ */
  .view { display:none; }
  .view.active { display:block; }

  /* ‚îÄ‚îÄ REPORT ‚îÄ‚îÄ */
  .report-options {
    display:flex; gap:16px; flex-wrap:wrap; margin-bottom:24px;
  }
  .report-card {
    flex:1; min-width:200px;
    background:var(--bg-panel); border:1px solid var(--border);
    border-radius:var(--radius); padding:20px;
    cursor:pointer; transition:all 0.2s;
    text-align:center;
  }
  .report-card:hover { border-color:var(--accent-cyan); transform:translateY(-2px); }
  .report-card-icon { font-size:36px; margin-bottom:10px; }
  .report-card-title { font-weight:700; font-size:14px; margin-bottom:6px; }
  .report-card-desc { font-size:12px; color:var(--text-secondary); }

  /* ‚îÄ‚îÄ LOADING ‚îÄ‚îÄ */
  .skeleton { background: linear-gradient(90deg, var(--bg-card) 25%, var(--border) 50%, var(--bg-card) 75%); background-size:400% 100%; animation:shimmer 1.5s infinite; border-radius:4px; }
  @keyframes shimmer { 0%{background-position:100% 0} 100%{background-position:-100% 0} }

  /* ‚îÄ‚îÄ PAGINATION ‚îÄ‚îÄ */
  .pagination { display:flex; align-items:center; gap:6px; margin-top:14px; justify-content:center; }
  .page-btn {
    background:var(--bg-panel); border:1px solid var(--border);
    border-radius:4px; padding:6px 12px;
    font-family:var(--mono); font-size:12px; color:var(--text-secondary);
    cursor:pointer; transition:all 0.2s;
  }
  .page-btn:hover, .page-btn.active { border-color:var(--accent-cyan); color:var(--accent-cyan); background:rgba(0,229,255,0.08); }
  .page-btn:disabled { opacity:0.4; cursor:not-allowed; }

  /* ‚îÄ‚îÄ NOTIFICATIONS ‚îÄ‚îÄ */
  .notif {
    position:fixed; bottom:24px; right:24px; z-index:999;
    background:var(--bg-panel); border:1px solid var(--border-bright);
    border-radius:var(--radius); padding:14px 20px;
    display:flex; align-items:center; gap:12px;
    font-size:14px; font-weight:600;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    animation: notifIn 0.3s ease;
    max-width:320px;
  }
  @keyframes notifIn { from{opacity:0;transform:translateY(10px)} to{opacity:1;transform:translateY(0)} }
  .notif-success { border-left:3px solid var(--accent-green); color:var(--accent-green); }
  .notif-error { border-left:3px solid var(--accent-red); color:var(--accent-red); }
  .notif-info { border-left:3px solid var(--accent-cyan); color:var(--accent-cyan); }

  /* ‚îÄ‚îÄ EMPTY STATE ‚îÄ‚îÄ */
  .empty-state {
    text-align:center; padding:60px 20px;
    color:var(--text-muted);
  }
  .empty-state-icon { font-size:48px; margin-bottom:16px; opacity:0.5; }
  .empty-state-text { font-size:14px; }

  /* ‚îÄ‚îÄ SCROLL ‚îÄ‚îÄ */
  ::-webkit-scrollbar { width:6px; height:6px; }
  ::-webkit-scrollbar-track { background:var(--bg-deep); }
  ::-webkit-scrollbar-thumb { background:var(--border-bright); border-radius:3px; }
  ::-webkit-scrollbar-thumb:hover { background:var(--text-muted); }

  /* ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ */
  @media(max-width:768px) {
    nav { display:none; }
    .detail-grid { grid-template-columns:1fr; }
    .table-wrap { overflow-x:auto; }
    main { padding:16px; }
  }

  /* ‚îÄ‚îÄ PRINT ‚îÄ‚îÄ */
  @media print {
    body { background:#fff; color:#000; }
    header, nav, .btn, .table-toolbar { display:none; }
    .table-wrap { border:1px solid #ccc; }
    th, td { color:#000; border-color:#ccc; }
  }

  /* Chip filter */
  .filter-chips { display:flex; gap:8px; flex-wrap:wrap; }
  .chip {
    padding:4px 12px; border-radius:20px;
    font-size:12px; font-weight:600; cursor:pointer;
    background:var(--bg-card); border:1px solid var(--border);
    color:var(--text-muted); transition:all 0.15s;
  }
  .chip.active { background:rgba(0,229,255,0.1); border-color:var(--accent-cyan); color:var(--accent-cyan); }

  .top-bar-mobile {
    display:none; background:var(--bg-panel); padding:12px 16px;
    gap:8px; flex-wrap:wrap; border-bottom:1px solid var(--border);
  }
  @media(max-width:768px) { .top-bar-mobile { display:flex; } }

  .view-header {
    display: flex; align-items: flex-start; justify-content: space-between;
    margin-bottom: 24px; gap: 12px; flex-wrap: wrap;
  }
</style>
</head>
<body>

<!-- HEADER -->
<header>
  <div class="logo-mark">
    <div class="logo-icon">SG</div>
    <div>
      <div class="logo-text">SGILAB</div>
      <div class="logo-sub">INVENTARIO ¬∑ LABORATORIO DE C√ìMPUTO</div>
    </div>
  </div>
  <nav>
    <button class="active" onclick="showView('dashboard')" id="nav-dashboard">‚¨° TABLERO</button>
    <button onclick="showView('equipos')" id="nav-equipos">‚äû EQUIPOS</button>
    <button onclick="showView('reportes')" id="nav-reportes">‚äü REPORTES</button>
    <button onclick="openModal()" class="btn btn-primary" style="margin-left:8px;">+ NUEVO EQUIPO</button>
  </nav>
</header>

<!-- MOBILE NAV -->
<div class="top-bar-mobile">
  <button class="btn btn-ghost btn-sm" onclick="showView('dashboard')">TABLERO</button>
  <button class="btn btn-ghost btn-sm" onclick="showView('equipos')">EQUIPOS</button>
  <button class="btn btn-ghost btn-sm" onclick="showView('reportes')">REPORTES</button>
  <button class="btn btn-primary btn-sm" onclick="openModal()">+ NUEVO</button>
</div>

<main>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê DASHBOARD ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="view active" id="view-dashboard">
    <div class="view-header">
      <div>
        <div class="section-title">TABLERO <span>GENERAL</span></div>
        <div style="font-size:12px; color:var(--text-muted); margin-top:4px; font-family:var(--mono);" id="dash-timestamp"></div>
      </div>
      <button class="btn btn-cyan btn-sm" onclick="renderDashboard()">‚Ü∫ ACTUALIZAR</button>
    </div>

    <div class="stats-grid" id="stats-grid">
      <div class="stat-card cyan">
        <div class="stat-label">Total Equipos</div>
        <div class="stat-value" id="st-total">0</div>
        <div class="stat-sub">registrados en sistema</div>
      </div>
      <div class="stat-card green">
        <div class="stat-label">Operativos</div>
        <div class="stat-value" id="st-ok">0</div>
        <div class="stat-sub">sin fallas reportadas</div>
      </div>
      <div class="stat-card amber">
        <div class="stat-label">En Mantenimiento</div>
        <div class="stat-value" id="st-mant">0</div>
        <div class="stat-sub">correctivo activo</div>
      </div>
      <div class="stat-card red">
        <div class="stat-label">Con Fallas</div>
        <div class="stat-value" id="st-falla">0</div>
        <div class="stat-sub">requieren atenci√≥n</div>
      </div>
      <div class="stat-card blue">
        <div class="stat-label">Sin Registrar</div>
        <div class="stat-value" id="st-pending">0</div>
        <div class="stat-sub">de 36 m√°quinas</div>
      </div>
    </div>

    <div class="section-title" style="margin-bottom:16px; font-size:16px;">RESUMEN DE <span>EQUIPOS</span></div>
    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>C√ìDIGO</th>
            <th>UBICACI√ìN</th>
            <th>IP</th>
            <th>PROCESADOR</th>
            <th>RAM</th>
            <th>√öLTIMO MANT.</th>
            <th>ESTADO</th>
            <th>ACCIONES</th>
          </tr>
        </thead>
        <tbody id="dash-table-body">
          <tr><td colspan="9" style="text-align:center;padding:40px;color:var(--text-muted);font-family:var(--mono)">Cargando datos...</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê EQUIPOS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="view" id="view-equipos">
    <div class="view-header">
      <div>
        <div class="section-title">GESTI√ìN DE <span>EQUIPOS</span></div>
        <div style="font-size:12px; color:var(--text-muted); margin-top:4px;">Laboratorio de C√≥mputo ‚Äî 36 estaciones</div>
      </div>
      <button class="btn btn-primary" onclick="openModal()">+ REGISTRAR EQUIPO</button>
    </div>

    <div class="table-toolbar">
      <div class="search-wrap">
        <span class="search-icon">‚åï</span>
        <input type="text" id="search-input" placeholder="Buscar por c√≥digo, IP, usuario..." oninput="filterEquipos()">
      </div>
      <div class="filter-chips">
        <div class="chip active" onclick="setFilter('all',this)">TODOS</div>
        <div class="chip" onclick="setFilter('operativo',this)">OPERATIVO</div>
        <div class="chip" onclick="setFilter('falla',this)">CON FALLA</div>
        <div class="chip" onclick="setFilter('mantenimiento',this)">MANTENIMIENTO</div>
      </div>
      <button class="btn btn-green btn-sm" onclick="exportCSV()">‚Üì EXPORTAR CSV</button>
    </div>

    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>C√ìDIGO</th>
            <th>UBICACI√ìN</th>
            <th>USUARIO</th>
            <th>IP</th>
            <th>MAC</th>
            <th>PROCESADOR</th>
            <th>RAM</th>
            <th>ALMAC.</th>
            <th>ESTADO</th>
            <th>ACCIONES</th>
          </tr>
        </thead>
        <tbody id="equip-table-body"></tbody>
      </table>
    </div>
    <div class="pagination" id="pagination"></div>
  </div>

  <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê REPORTES ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
  <div class="view" id="view-reportes">
    <div class="view-header">
      <div>
        <div class="section-title">GENERACI√ìN DE <span>REPORTES</span></div>
        <div style="font-size:12px; color:var(--text-muted); margin-top:4px;">Exportar datos del inventario del laboratorio</div>
      </div>
    </div>

    <div class="report-options">
      <div class="report-card" onclick="printReport()">
        <div class="report-card-icon">üñ®Ô∏è</div>
        <div class="report-card-title">REPORTE PDF</div>
        <div class="report-card-desc">Informe t√©cnico completo para impresi√≥n o PDF</div>
      </div>
      <div class="report-card" onclick="exportCSV()">
        <div class="report-card-icon">üìä</div>
        <div class="report-card-title">EXPORTAR CSV</div>
        <div class="report-card-desc">Compatible con Excel y Google Sheets</div>
      </div>
      <div class="report-card" onclick="exportJSON()">
        <div class="report-card-icon">üìÑ</div>
        <div class="report-card-title">EXPORTAR JSON</div>
        <div class="report-card-desc">Datos estructurados para integraci√≥n</div>
      </div>
    </div>

    <!-- Preview del reporte -->
    <div class="table-wrap" style="margin-top:10px;">
      <div style="padding:20px 24px; border-bottom:1px solid var(--border);">
        <div style="font-family:var(--mono); font-size:12px; color:var(--accent-cyan); letter-spacing:2px;">VISTA PREVIA DEL REPORTE</div>
        <div style="font-size:13px; color:var(--text-secondary); margin-top:4px;" id="report-summary"></div>
      </div>
      <table>
        <thead>
          <tr>
            <th>C√ìDIGO</th>
            <th>UBICACI√ìN</th>
            <th>IP</th>
            <th>PROCESADOR</th>
            <th>RAM</th>
            <th>ALMAC.</th>
            <th>√öLTIMO MANT.</th>
            <th>TIPO MANT.</th>
            <th>FALLAS</th>
            <th>ESTADO</th>
          </tr>
        </thead>
        <tbody id="report-table-body"></tbody>
      </table>
    </div>
  </div>

</main>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODAL FORMULARIO ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="modal-overlay" id="modal-overlay">
  <div class="modal">
    <div class="modal-header">
      <div class="modal-title" id="modal-title">REGISTRAR NUEVO EQUIPO</div>
      <button class="modal-close" onclick="closeModal()">‚úï</button>
    </div>
    <div class="modal-body">
      <form id="equip-form" novalidate>
        <!-- DATOS GENERALES -->
        <div class="form-section">
          <div class="form-section-title">DATOS GENERALES</div>
          <div class="form-grid">
            <div class="form-group">
              <label>C√≥digo / N√∫mero de Equipo *</label>
              <input type="text" id="f-codigo" placeholder="EQ-LAB-001" maxlength="20">
              <div class="error-msg" id="err-codigo"></div>
            </div>
            <div class="form-group">
              <label>Ubicaci√≥n / Aula *</label>
              <input type="text" id="f-ubicacion" placeholder="Laboratorio A, Sala 1...">
              <div class="error-msg" id="err-ubicacion"></div>
            </div>
            <div class="form-group">
              <label>Usuario Asignado</label>
              <input type="text" id="f-usuario" placeholder="Nombre del usuario o N/A">
            </div>
            <div class="form-group">
              <label>Estado General *</label>
              <select id="f-estado">
                <option value="operativo">‚úÖ Operativo</option>
                <option value="falla">‚ùå Con Falla</option>
                <option value="mantenimiento">üîß En Mantenimiento</option>
              </select>
            </div>
          </div>
        </div>

        <!-- COMPONENTES -->
        <div class="form-section">
          <div class="form-section-title">COMPONENTES PRINCIPALES</div>
          <div class="form-grid">
            <div class="form-group">
              <label>Procesador ‚Äî Marca</label>
              <input type="text" id="f-cpu-marca" placeholder="Intel, AMD...">
            </div>
            <div class="form-group">
              <label>Procesador ‚Äî Modelo</label>
              <input type="text" id="f-cpu-modelo" placeholder="Core i5-10400, Ryzen 5...">
            </div>
            <div class="form-group">
              <label>Procesador ‚Äî Velocidad</label>
              <input type="text" id="f-cpu-ghz" placeholder="2.9 GHz / 4.3 GHz boost">
            </div>
            <div class="form-group">
              <label>RAM ‚Äî Capacidad *</label>
              <select id="f-ram-cap">
                <option>4 GB</option><option>8 GB</option><option>16 GB</option>
                <option>32 GB</option><option>64 GB</option>
              </select>
            </div>
            <div class="form-group">
              <label>RAM ‚Äî Tipo</label>
              <select id="f-ram-tipo">
                <option>DDR3</option><option>DDR4</option><option>DDR5</option>
              </select>
            </div>
            <div class="form-group">
              <label>Almacenamiento ‚Äî Tipo</label>
              <select id="f-hdd-tipo">
                <option>HDD</option><option>SSD</option><option>NVMe SSD</option>
                <option>M.2 SSD</option><option>HDD + SSD</option>
              </select>
            </div>
            <div class="form-group">
              <label>Almacenamiento ‚Äî Capacidad</label>
              <input type="text" id="f-hdd-cap" placeholder="500 GB, 1 TB...">
            </div>
            <div class="form-group">
              <label>Pantalla ‚Äî Marca</label>
              <input type="text" id="f-monitor-marca" placeholder="Samsung, LG, Dell...">
            </div>
            <div class="form-group">
              <label>Pantalla ‚Äî Tama√±o</label>
              <input type="text" id="f-monitor-tam" placeholder='19", 21.5", 24"...'>
            </div>
            <div class="form-group">
              <label>Teclado ‚Äî Marca</label>
              <input type="text" id="f-teclado-marca" placeholder="Logitech, HP...">
            </div>
            <div class="form-group">
              <label>Teclado ‚Äî Estado</label>
              <select id="f-teclado-estado">
                <option value="bueno">Bueno</option>
                <option value="regular">Regular</option>
                <option value="malo">Malo</option>
              </select>
            </div>
            <div class="form-group">
              <label>Mouse ‚Äî Marca</label>
              <input type="text" id="f-mouse-marca" placeholder="Logitech, HP...">
            </div>
            <div class="form-group">
              <label>Mouse ‚Äî Estado</label>
              <select id="f-mouse-estado">
                <option value="bueno">Bueno</option>
                <option value="regular">Regular</option>
                <option value="malo">Malo</option>
              </select>
            </div>
          </div>
        </div>

        <!-- RED -->
        <div class="form-section">
          <div class="form-section-title">CONFIGURACI√ìN DE RED Y CABLEADO</div>
          <div class="form-grid">
            <div class="form-group">
              <label>Direcci√≥n IP *</label>
              <input type="text" id="f-ip" placeholder="192.168.1.1">
              <div class="error-msg" id="err-ip"></div>
            </div>
            <div class="form-group">
              <label>Direcci√≥n MAC</label>
              <input type="text" id="f-mac" placeholder="AA:BB:CC:DD:EE:FF">
            </div>
            <div class="form-group">
              <label>Puerto Switch</label>
              <input type="text" id="f-puerto-sw" placeholder="Fa0/1, Gi0/12...">
            </div>
            <div class="form-group">
              <label>Puerto Patch Panel</label>
              <input type="text" id="f-puerto-pp" placeholder="PP-01, Puerto 12...">
            </div>
            <div class="form-group">
              <label>Rack de Comunicaciones</label>
              <input type="text" id="f-rack" placeholder="Rack A, Rack Principal...">
            </div>
            <div class="form-group">
              <label>Tipo de Cable</label>
              <select id="f-cable-tipo">
                <option>UTP Cat5e</option>
                <option>UTP Cat6</option>
                <option>UTP Cat6A</option>
                <option>FTP Cat6</option>
                <option>Fibra √ìptica</option>
              </select>
            </div>
            <div class="form-group full">
              <label>Observaciones del Cableado</label>
              <textarea id="f-cable-obs" placeholder="Estado del cable, longitud aproximada, anomal√≠as..."></textarea>
            </div>
          </div>
        </div>

        <!-- MANTENIMIENTO -->
        <div class="form-section">
          <div class="form-section-title">REGISTRO DE MANTENIMIENTO</div>
          <div class="form-grid">
            <div class="form-group">
              <label>Fecha √öltimo Mantenimiento</label>
              <input type="date" id="f-mant-fecha">
            </div>
            <div class="form-group">
              <label>Tipo de Mantenimiento</label>
              <select id="f-mant-tipo">
                <option value="">Sin registro</option>
                <option value="preventivo">Preventivo</option>
                <option value="correctivo">Correctivo</option>
              </select>
            </div>
            <div class="form-group full">
              <label>Fallas Detectadas</label>
              <textarea id="f-fallas" placeholder="Descripci√≥n de fallas o problemas encontrados..."></textarea>
            </div>
            <div class="form-group full">
              <label>Soluci√≥n Aplicada</label>
              <textarea id="f-solucion" placeholder="Acciones correctivas tomadas, piezas reemplazadas..."></textarea>
            </div>
          </div>
        </div>

      </form>
    </div>
    <div class="modal-footer">
      <button class="btn btn-ghost" onclick="closeModal()">CANCELAR</button>
      <button class="btn btn-primary" onclick="saveEquipo()">GUARDAR EQUIPO</button>
    </div>
  </div>
</div>

<!-- DETAIL MODAL -->
<div class="modal-overlay" id="detail-overlay">
  <div class="modal" style="max-width:1000px;">
    <div class="modal-header">
      <div>
        <div class="modal-title" id="detail-title">FICHA T√âCNICA</div>
        <div id="detail-sub" style="font-family:var(--mono); font-size:12px; color:var(--text-muted); margin-top:3px;"></div>
      </div>
      <button class="modal-close" onclick="closeDetail()">‚úï</button>
    </div>
    <div class="modal-body" id="detail-body"></div>
    <div class="modal-footer">
      <button class="btn btn-ghost" onclick="closeDetail()">CERRAR</button>
      <button class="btn btn-amber" id="detail-edit-btn">‚úé EDITAR</button>
    </div>
  </div>
</div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STORE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const STORE_KEY = 'sgilab_v1';
let equipos = [];
let editingId = null;
let currentFilter = 'all';
let currentPage = 1;
const PAGE_SIZE = 12;

function loadData() {
  try {
    const raw = localStorage.getItem(STORE_KEY);
    equipos = raw ? JSON.parse(raw) : [];
  } catch(e) { equipos = []; }
}
function saveData() {
  localStorage.setItem(STORE_KEY, JSON.stringify(equipos));
}
function genId() { return Date.now().toString(36) + Math.random().toString(36).substr(2,5); }

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SEED DATA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function seedData() {
  if(equipos.length > 0) return;
  const cpus = ['Intel Core i5-10400','Intel Core i7-10700','AMD Ryzen 5 3600','Intel Core i5-8400','AMD Ryzen 3 3200G'];
  const rams = ['8 GB','16 GB','8 GB','16 GB','4 GB'];
  const hdds = ['HDD 500 GB','SSD 256 GB','SSD 512 GB','NVMe SSD 512 GB','HDD 1 TB'];
  const monitors = ['Samsung 21.5"','LG 19"','Dell 23"','Acer 21.5"','HP 20"'];
  const estados = ['operativo','operativo','operativo','operativo','falla','mantenimiento','operativo','operativo'];
  const fallas = ['','','','','Pantalla con l√≠neas horizontales','Fan de CPU ruidoso','','','','Sistema no arranca correctamente'];
  for(let i=1; i<=36; i++) {
    const idx = (i-1)%5;
    const est = estados[(i-1)%estados.length];
    const falla = fallas[(i-1)%fallas.length];
    equipos.push({
      id: genId(),
      codigo: `EQ-LAB-${String(i).padStart(3,'0')}`,
      ubicacion: `Laboratorio A ‚Äî Fila ${Math.ceil(i/6)}`,
      usuario: i%4===0 ? 'N/A' : `Estudiante ${String.fromCharCode(64+i%26+1)}`,
      estado: est,
      cpu_marca: idx<3?'Intel':'AMD',
      cpu_modelo: cpus[idx],
      cpu_ghz: ['2.9 GHz','2.9 GHz','3.6 GHz','2.8 GHz','3.6 GHz'][idx],
      ram_cap: rams[idx],
      ram_tipo: ['DDR4','DDR4','DDR4','DDR4','DDR3'][idx],
      hdd_tipo: ['HDD','SSD','SSD','NVMe SSD','HDD'][idx],
      hdd_cap: ['500 GB','256 GB','512 GB','512 GB','1 TB'][idx],
      monitor_marca: monitors[idx].split(' ')[0],
      monitor_tam: monitors[idx].split(' ')[1],
      teclado_marca: ['Logitech','HP','HP','Dell','Logitech'][idx],
      teclado_estado: i%7===0?'regular':'bueno',
      mouse_marca: ['Logitech','HP','HP','Dell','HP'][idx],
      mouse_estado: i%9===0?'regular':'bueno',
      ip: `192.168.1.${i+100}`,
      mac: Array.from({length:6},()=>Math.floor(Math.random()*255).toString(16).padStart(2,'0').toUpperCase()).join(':'),
      puerto_sw: `Fa0/${i}`,
      puerto_pp: `PP-${String(i).padStart(2,'0')}`,
      rack: i<=18?'Rack A':'Rack B',
      cable_tipo: 'UTP Cat6',
      cable_obs: '',
      mant_fecha: '2025-01-15',
      mant_tipo: i%3===0?'correctivo':'preventivo',
      fallas: falla,
      solucion: falla ? 'Equipo en revisi√≥n' : '',
      creado: new Date().toISOString()
    });
  }
  saveData();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// VIEWS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showView(name) {
  document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
  document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
  document.getElementById('view-'+name).classList.add('active');
  const nb = document.getElementById('nav-'+name);
  if(nb) nb.classList.add('active');
  if(name==='dashboard') renderDashboard();
  if(name==='equipos') { currentPage=1; renderEquipos(); }
  if(name==='reportes') renderReporte();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DASHBOARD
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderDashboard() {
  const total = equipos.length;
  const ok = equipos.filter(e=>e.estado==='operativo').length;
  const mant = equipos.filter(e=>e.estado==='mantenimiento').length;
  const falla = equipos.filter(e=>e.estado==='falla').length;
  document.getElementById('st-total').textContent = total;
  document.getElementById('st-ok').textContent = ok;
  document.getElementById('st-mant').textContent = mant;
  document.getElementById('st-falla').textContent = falla;
  document.getElementById('st-pending').textContent = Math.max(0, 36 - total);
  document.getElementById('dash-timestamp').textContent = '√öltima actualizaci√≥n: ' + new Date().toLocaleString('es-MX');

  const tbody = document.getElementById('dash-table-body');
  if(equipos.length===0) {
    tbody.innerHTML = `<tr><td colspan="9"><div class="empty-state"><div class="empty-state-icon">üì¶</div><div class="empty-state-text">No hay equipos registrados. Haga clic en "+ NUEVO EQUIPO"</div></div></td></tr>`;
    return;
  }
  tbody.innerHTML = equipos.slice(0,10).map((e,i) => `
    <tr>
      <td class="td-mono" style="color:var(--text-muted)">${String(i+1).padStart(2,'0')}</td>
      <td class="td-bold">${e.codigo}</td>
      <td style="color:var(--text-secondary)">${e.ubicacion}</td>
      <td class="td-mono" style="color:var(--accent-cyan)">${e.ip}</td>
      <td style="font-size:12px;">${e.cpu_modelo||'‚Äî'}</td>
      <td class="td-mono">${e.ram_cap}</td>
      <td class="td-mono" style="font-size:11px;">${e.mant_fecha||'‚Äî'}</td>
      <td>${estadoBadge(e.estado)}</td>
      <td>
        <button class="btn btn-ghost btn-sm" onclick="showDetail('${e.id}')">VER</button>
        <button class="btn btn-cyan btn-sm" onclick="editEquipo('${e.id}')">‚úé</button>
      </td>
    </tr>
  `).join('');
  if(equipos.length>10) {
    tbody.innerHTML += `<tr><td colspan="9" style="text-align:center;padding:12px;"><button class="btn btn-ghost btn-sm" onclick="showView('equipos')">Ver todos los ${equipos.length} equipos ‚Üí</button></td></tr>`;
  }
}

function estadoBadge(estado) {
  const map = {
    'operativo': ['badge-good','OPERATIVO'],
    'falla': ['badge-bad','CON FALLA'],
    'mantenimiento': ['badge-warn','MANTENIMIENTO']
  };
  const [cls,label] = map[estado] || ['badge-info',estado.toUpperCase()];
  return `<span class="badge ${cls}">${label}</span>`;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// EQUIPOS TABLE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let activeFilter = 'all';
function setFilter(f, el) {
  activeFilter = f;
  document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
  el.classList.add('active');
  currentPage = 1;
  renderEquipos();
}
function filterEquipos() { currentPage=1; renderEquipos(); }

function getFiltered() {
  const q = (document.getElementById('search-input')?.value||'').toLowerCase();
  return equipos.filter(e => {
    const matchFilter = activeFilter==='all' || e.estado===activeFilter;
    const matchQ = !q || [e.codigo,e.ip,e.usuario,e.ubicacion,e.cpu_modelo,e.mac].some(v=>(v||'').toLowerCase().includes(q));
    return matchFilter && matchQ;
  });
}

function renderEquipos() {
  const filtered = getFiltered();
  const start = (currentPage-1)*PAGE_SIZE;
  const page = filtered.slice(start, start+PAGE_SIZE);
  const tbody = document.getElementById('equip-table-body');
  if(filtered.length===0) {
    tbody.innerHTML = `<tr><td colspan="11"><div class="empty-state"><div class="empty-state-icon">üîç</div><div class="empty-state-text">No se encontraron equipos con los criterios actuales</div></div></td></tr>`;
  } else {
    tbody.innerHTML = page.map((e,i) => `
      <tr>
        <td class="td-mono" style="color:var(--text-muted)">${start+i+1}</td>
        <td class="td-bold td-mono">${e.codigo}</td>
        <td style="font-size:12px;max-width:140px;overflow:hidden;text-overflow:ellipsis">${e.ubicacion}</td>
        <td style="font-size:12px;">${e.usuario||'‚Äî'}</td>
        <td class="td-mono" style="color:var(--accent-cyan)">${e.ip}</td>
        <td class="td-mono" style="font-size:11px;color:var(--text-muted)">${e.mac}</td>
        <td style="font-size:12px;">${e.cpu_modelo||'‚Äî'}</td>
        <td class="td-mono">${e.ram_cap} ${e.ram_tipo}</td>
        <td class="td-mono">${e.hdd_tipo} ${e.hdd_cap}</td>
        <td>${estadoBadge(e.estado)}</td>
        <td style="white-space:nowrap;">
          <button class="btn btn-ghost btn-sm" onclick="showDetail('${e.id}')">VER</button>
          <button class="btn btn-cyan btn-sm" onclick="editEquipo('${e.id}')">‚úé</button>
          <button class="btn btn-danger btn-sm" onclick="deleteEquipo('${e.id}')">‚úï</button>
        </td>
      </tr>
    `).join('');
  }
  renderPagination(filtered.length);
}

function renderPagination(total) {
  const pages = Math.ceil(total/PAGE_SIZE);
  const el = document.getElementById('pagination');
  if(pages<=1){ el.innerHTML=''; return; }
  let html = `<button class="page-btn" onclick="goPage(${currentPage-1})" ${currentPage===1?'disabled':''}>‚Äπ</button>`;
  for(let p=1;p<=pages;p++) {
    html += `<button class="page-btn ${p===currentPage?'active':''}" onclick="goPage(${p})">${p}</button>`;
  }
  html += `<button class="page-btn" onclick="goPage(${currentPage+1})" ${currentPage===pages?'disabled':''}>‚Ä∫</button>`;
  el.innerHTML = html;
}
function goPage(p) { currentPage=p; renderEquipos(); }

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// MODAL CRUD
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function openModal(id=null) {
  editingId = id;
  clearForm();
  if(id) {
    const e = equipos.find(x=>x.id===id);
    if(!e) return;
    document.getElementById('modal-title').textContent = 'EDITAR EQUIPO ‚Äî ' + e.codigo;
    fillForm(e);
  } else {
    document.getElementById('modal-title').textContent = 'REGISTRAR NUEVO EQUIPO';
  }
  document.getElementById('modal-overlay').classList.add('open');
}
function closeModal() {
  document.getElementById('modal-overlay').classList.remove('open');
  editingId = null;
}

function clearForm() {
  document.getElementById('equip-form').reset();
  document.querySelectorAll('.error-msg').forEach(e => e.textContent='');
  document.querySelectorAll('.input-error').forEach(e => e.classList.remove('input-error'));
}

function fillForm(e) {
  const fields = {
    'f-codigo':e.codigo,'f-ubicacion':e.ubicacion,'f-usuario':e.usuario,'f-estado':e.estado,
    'f-cpu-marca':e.cpu_marca,'f-cpu-modelo':e.cpu_modelo,'f-cpu-ghz':e.cpu_ghz,
    'f-ram-cap':e.ram_cap,'f-ram-tipo':e.ram_tipo,'f-hdd-tipo':e.hdd_tipo,'f-hdd-cap':e.hdd_cap,
    'f-monitor-marca':e.monitor_marca,'f-monitor-tam':e.monitor_tam,
    'f-teclado-marca':e.teclado_marca,'f-teclado-estado':e.teclado_estado,
    'f-mouse-marca':e.mouse_marca,'f-mouse-estado':e.mouse_estado,
    'f-ip':e.ip,'f-mac':e.mac,'f-puerto-sw':e.puerto_sw,'f-puerto-pp':e.puerto_pp,
    'f-rack':e.rack,'f-cable-tipo':e.cable_tipo,'f-cable-obs':e.cable_obs,
    'f-mant-fecha':e.mant_fecha,'f-mant-tipo':e.mant_tipo,'f-fallas':e.fallas,'f-solucion':e.solucion
  };
  for(const [id,val] of Object.entries(fields)) {
    const el = document.getElementById(id);
    if(el) el.value = val||'';
  }
}

function getFormData() {
  const g = id => (document.getElementById(id)?.value||'').trim();
  return {
    codigo: g('f-codigo'), ubicacion: g('f-ubicacion'), usuario: g('f-usuario'), estado: g('f-estado'),
    cpu_marca: g('f-cpu-marca'), cpu_modelo: g('f-cpu-modelo'), cpu_ghz: g('f-cpu-ghz'),
    ram_cap: g('f-ram-cap'), ram_tipo: g('f-ram-tipo'), hdd_tipo: g('f-hdd-tipo'), hdd_cap: g('f-hdd-cap'),
    monitor_marca: g('f-monitor-marca'), monitor_tam: g('f-monitor-tam'),
    teclado_marca: g('f-teclado-marca'), teclado_estado: g('f-teclado-estado'),
    mouse_marca: g('f-mouse-marca'), mouse_estado: g('f-mouse-estado'),
    ip: g('f-ip'), mac: g('f-mac'), puerto_sw: g('f-puerto-sw'), puerto_pp: g('f-puerto-pp'),
    rack: g('f-rack'), cable_tipo: g('f-cable-tipo'), cable_obs: g('f-cable-obs'),
    mant_fecha: g('f-mant-fecha'), mant_tipo: g('f-mant-tipo'), fallas: g('f-fallas'), solucion: g('f-solucion')
  };
}

function validateForm(data) {
  let valid = true;
  const req = [['codigo','err-codigo','C√≥digo requerido'],['ubicacion','err-ubicacion','Ubicaci√≥n requerida'],['ip','err-ip','IP requerida']];
  req.forEach(([field,err,msg]) => {
    const el = document.getElementById('f-'+field.replace('_','-'));
    const em = document.getElementById(err);
    if(!data[field]) {
      if(el) el.classList.add('input-error');
      if(em) em.textContent = msg;
      valid = false;
    } else {
      if(el) el.classList.remove('input-error');
      if(em) em.textContent = '';
    }
  });
  // IP format
  const ipEl = document.getElementById('f-ip');
  const ipErr = document.getElementById('err-ip');
  if(data.ip && !/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/.test(data.ip)) {
    ipEl.classList.add('input-error');
    ipErr.textContent = 'Formato IP inv√°lido (ej: 192.168.1.1)';
    valid = false;
  }
  // Duplicate code
  if(data.codigo) {
    const dup = equipos.find(e => e.codigo===data.codigo && e.id!==editingId);
    if(dup) {
      document.getElementById('f-codigo').classList.add('input-error');
      document.getElementById('err-codigo').textContent = 'C√≥digo ya existe';
      valid = false;
    }
  }
  return valid;
}

function saveEquipo() {
  const data = getFormData();
  if(!validateForm(data)) return;
  if(editingId) {
    const idx = equipos.findIndex(e=>e.id===editingId);
    equipos[idx] = { ...equipos[idx], ...data };
    notify('Equipo actualizado correctamente','success');
  } else {
    equipos.push({ id:genId(), ...data, creado: new Date().toISOString() });
    notify('Equipo registrado correctamente','success');
  }
  saveData();
  closeModal();
  renderDashboard();
  renderEquipos();
  renderReporte();
}

function editEquipo(id) {
  closeDetail();
  openModal(id);
}

function deleteEquipo(id) {
  const e = equipos.find(x=>x.id===id);
  if(!e) return;
  if(!confirm(`¬øEliminar el equipo ${e.codigo}? Esta acci√≥n no se puede deshacer.`)) return;
  equipos = equipos.filter(x=>x.id!==id);
  saveData();
  renderDashboard();
  renderEquipos();
  renderReporte();
  notify(`Equipo ${e.codigo} eliminado`,'info');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DETAIL VIEW
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function showDetail(id) {
  const e = equipos.find(x=>x.id===id);
  if(!e) return;
  document.getElementById('detail-title').textContent = `FICHA T√âCNICA ‚Äî ${e.codigo}`;
  document.getElementById('detail-sub').textContent = `${e.ubicacion} ¬∑ ${e.ip} ¬∑ ${estadoBadge(e.estado).replace(/<[^>]+>/g,'')}`;
  document.getElementById('detail-edit-btn').onclick = () => editEquipo(id);
  document.getElementById('detail-body').innerHTML = `
    <div class="detail-grid">
      <div class="detail-section">
        <div class="detail-section-title">üìã DATOS GENERALES</div>
        ${dr('C√≥digo',e.codigo)}${dr('Ubicaci√≥n',e.ubicacion)}${dr('Usuario',e.usuario)}${dr('Estado',estadoBadge(e.estado))}
      </div>
      <div class="detail-section">
        <div class="detail-section-title">üîå PROCESADOR & MEMORIA</div>
        ${dr('CPU Marca',e.cpu_marca)}${dr('CPU Modelo',e.cpu_modelo)}${dr('Velocidad',e.cpu_ghz)}${dr('RAM',`${e.ram_cap} ${e.ram_tipo}`)}
      </div>
      <div class="detail-section">
        <div class="detail-section-title">üíæ ALMACENAMIENTO & PERIF√âRICOS</div>
        ${dr('Almacenamiento',`${e.hdd_tipo} ${e.hdd_cap}`)}${dr('Monitor',`${e.monitor_marca} ${e.monitor_tam}`)}
        ${dr('Teclado',`${e.teclado_marca} ‚Äî ${e.teclado_estado}`)}${dr('Mouse',`${e.mouse_marca} ‚Äî ${e.mouse_estado}`)}
      </div>
      <div class="detail-section">
        <div class="detail-section-title">üåê RED Y CABLEADO</div>
        ${dr('IP',e.ip)}${dr('MAC',e.mac)}${dr('Puerto Switch',e.puerto_sw)}${dr('Puerto Patch',e.puerto_pp)}
        ${dr('Rack',e.rack)}${dr('Cable',e.cable_tipo)}
        ${e.cable_obs?dr('Obs. Cableado',e.cable_obs):''}
      </div>
      <div class="detail-section" style="grid-column:1/-1">
        <div class="detail-section-title">üîß MANTENIMIENTO</div>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px;">
          <div>${dr('Fecha',e.mant_fecha||'No registrada')}${dr('Tipo',e.mant_tipo||'‚Äî')}</div>
          <div>${dr('Fallas Detectadas',e.fallas||'Ninguna')}</div>
          <div>${dr('Soluci√≥n Aplicada',e.solucion||'N/A')}</div>
        </div>
      </div>
    </div>
  `;
  document.getElementById('detail-overlay').classList.add('open');
}
function dr(key,val) {
  return `<div class="detail-row"><span class="detail-key">${key}</span><span class="detail-val">${val||'‚Äî'}</span></div>`;
}
function closeDetail() {
  document.getElementById('detail-overlay').classList.remove('open');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// REPORT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderReporte() {
  const total = equipos.length;
  const ok = equipos.filter(e=>e.estado==='operativo').length;
  document.getElementById('report-summary').textContent = `Total: ${total} equipos | ${ok} operativos | ${total-ok} con incidencias | Generado: ${new Date().toLocaleString('es-MX')}`;
  document.getElementById('report-table-body').innerHTML = equipos.map(e=>`
    <tr>
      <td class="td-mono td-bold">${e.codigo}</td>
      <td>${e.ubicacion}</td>
      <td class="td-mono" style="color:var(--accent-cyan)">${e.ip}</td>
      <td style="font-size:12px;">${e.cpu_modelo||'‚Äî'}</td>
      <td class="td-mono">${e.ram_cap}</td>
      <td class="td-mono">${e.hdd_tipo} ${e.hdd_cap}</td>
      <td class="td-mono" style="font-size:11px;">${e.mant_fecha||'‚Äî'}</td>
      <td style="font-size:12px;">${e.mant_tipo||'‚Äî'}</td>
      <td style="font-size:12px;max-width:160px;overflow:hidden;text-overflow:ellipsis">${e.fallas||'Ninguna'}</td>
      <td>${estadoBadge(e.estado)}</td>
    </tr>
  `).join('') || `<tr><td colspan="10" style="text-align:center;padding:30px;color:var(--text-muted)">Sin datos</td></tr>`;
}

function exportCSV() {
  const headers = ['C√≥digo','Ubicaci√≥n','Usuario','Estado','CPU Marca','CPU Modelo','CPU GHz','RAM Capacidad','RAM Tipo','HDD Tipo','HDD Capacidad','Monitor Marca','Monitor Tama√±o','Teclado Marca','Teclado Estado','Mouse Marca','Mouse Estado','IP','MAC','Puerto Switch','Puerto Patch Panel','Rack','Tipo Cable','Obs. Cableado','Fecha Mantenimiento','Tipo Mantenimiento','Fallas','Soluci√≥n'];
  const rows = equipos.map(e=>[e.codigo,e.ubicacion,e.usuario,e.estado,e.cpu_marca,e.cpu_modelo,e.cpu_ghz,e.ram_cap,e.ram_tipo,e.hdd_tipo,e.hdd_cap,e.monitor_marca,e.monitor_tam,e.teclado_marca,e.teclado_estado,e.mouse_marca,e.mouse_estado,e.ip,e.mac,e.puerto_sw,e.puerto_pp,e.rack,e.cable_tipo,e.cable_obs,e.mant_fecha,e.mant_tipo,e.fallas,e.solucion].map(v=>`"${(v||'').replace(/"/g,'""')}"`).join(','));
  const csv = [headers.join(','),...rows].join('\n');
  download('\ufeff'+csv,`inventario_lab_${new Date().toISOString().split('T')[0]}.csv`,'text/csv');
  notify('Archivo CSV generado correctamente','success');
}

function exportJSON() {
  download(JSON.stringify(equipos,null,2),`inventario_lab_${new Date().toISOString().split('T')[0]}.json`,'application/json');
  notify('Archivo JSON exportado','success');
}

function download(content, filename, type) {
  const a = document.createElement('a');
  a.href = URL.createObjectURL(new Blob([content],{type}));
  a.download = filename; a.click();
  URL.revokeObjectURL(a.href);
}

function printReport() {
  const fecha = new Date().toLocaleString('es-MX');
  const rows = equipos.map((e,i)=>`
    <tr>
      <td>${i+1}</td><td>${e.codigo}</td><td>${e.ubicacion}</td><td>${e.ip}</td>
      <td>${e.cpu_modelo||'‚Äî'}</td><td>${e.ram_cap} ${e.ram_tipo}</td>
      <td>${e.hdd_tipo} ${e.hdd_cap}</td><td>${e.mant_fecha||'‚Äî'}</td>
      <td>${e.mant_tipo||'‚Äî'}</td><td>${e.fallas||'Ninguna'}</td><td>${e.estado.toUpperCase()}</td>
    </tr>`).join('');
  const ok=equipos.filter(e=>e.estado==='operativo').length;
  const wnd = window.open('','_blank');
  wnd.document.write(`<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8">
    <title>Reporte Inventario Laboratorio</title>
    <style>
      body{font-family:Arial,sans-serif;font-size:11px;color:#111;padding:20px}
      h1{font-size:18px;margin-bottom:4px}
      .meta{font-size:11px;color:#555;margin-bottom:20px}
      table{width:100%;border-collapse:collapse;margin-top:10px}
      th{background:#1a3a5c;color:#fff;padding:6px 8px;text-align:left;font-size:10px}
      td{padding:5px 8px;border-bottom:1px solid #ddd;vertical-align:top}
      tr:nth-child(even){background:#f5f8ff}
      .summary{display:flex;gap:20px;margin-bottom:20px}
      .sum-box{border:1px solid #ccc;padding:10px 16px;border-radius:4px;min-width:100px;text-align:center}
      .sum-num{font-size:24px;font-weight:bold;color:#1a3a5c}
      .sum-lbl{font-size:10px;color:#555;text-transform:uppercase}
      @media print{body{padding:10px}button{display:none}}
    </style>
  </head><body>
    <h1>INFORME T√âCNICO ‚Äî INVENTARIO LABORATORIO DE C√ìMPUTO</h1>
    <div class="meta">Fecha de generaci√≥n: ${fecha} | Sistema: SGILAB v1.0</div>
    <div class="summary">
      <div class="sum-box"><div class="sum-num">${equipos.length}</div><div class="sum-lbl">Total Equipos</div></div>
      <div class="sum-box"><div class="sum-num" style="color:#0a6e2e">${ok}</div><div class="sum-lbl">Operativos</div></div>
      <div class="sum-box"><div class="sum-num" style="color:#b8860b">${equipos.filter(e=>e.estado==='mantenimiento').length}</div><div class="sum-lbl">Mantenimiento</div></div>
      <div class="sum-box"><div class="sum-num" style="color:#c0392b">${equipos.filter(e=>e.estado==='falla').length}</div><div class="sum-lbl">Con Falla</div></div>
    </div>
    <table>
      <thead><tr><th>#</th><th>C√ìDIGO</th><th>UBICACI√ìN</th><th>IP</th><th>PROCESADOR</th><th>RAM</th><th>ALMACENAMIENTO</th><th>√öLT. MANT.</th><th>TIPO MANT.</th><th>FALLAS</th><th>ESTADO</th></tr></thead>
      <tbody>${rows}</tbody>
    </table>
    <div style="margin-top:30px;border-top:1px solid #ccc;padding-top:12px;font-size:10px;color:#999">
      Documento generado autom√°ticamente por SGILAB ‚Äî Sistema de Gesti√≥n de Inventario de Laboratorio
    </div>
    <script>window.onload=()=>{window.print()}<\/script>
  </body></html>`);
  wnd.document.close();
  notify('Reporte PDF generado','success');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// NOTIFICATIONS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function notify(msg, type='info') {
  const icons = {success:'‚úì',error:'‚úï',info:'‚Ñπ'};
  const el = document.createElement('div');
  el.className = `notif notif-${type}`;
  el.innerHTML = `<span>${icons[type]}</span><span>${msg}</span>`;
  document.body.appendChild(el);
  setTimeout(()=>{ el.style.opacity='0'; el.style.transition='opacity 0.3s'; setTimeout(()=>el.remove(),300); }, 3000);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CLOSE ON OVERLAY CLICK
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
document.getElementById('modal-overlay').addEventListener('click',function(e){ if(e.target===this) closeModal(); });
document.getElementById('detail-overlay').addEventListener('click',function(e){ if(e.target===this) closeDetail(); });
document.addEventListener('keydown',e=>{ if(e.key==='Escape'){closeModal();closeDetail();} });

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INIT
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
loadData();
seedData();
renderDashboard();
renderEquipos();
renderReporte();
</script>
</body>
</html>
